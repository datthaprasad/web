{"ast":null,"code":"import _regeneratorRuntime from\"D:/WEB_MINI_PROJECT/web/ReactJS/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"D:/WEB_MINI_PROJECT/web/ReactJS/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"D:/WEB_MINI_PROJECT/web/ReactJS/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useCallback,useRef,useEffect}from'react';export var useHttpClient=function useHttpClient(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),error=_useState4[0],setError=_useState4[1];var activeHttpRequests=useRef([]);var sendRequest=useCallback(/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(url){var method,headers,body,httpAbortCtrl,response,responseData,_args=arguments;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:method=_args.length>1&&_args[1]!==undefined?_args[1]:'GET';headers=_args.length>2&&_args[2]!==undefined?_args[2]:{};body=_args.length>3&&_args[3]!==undefined?_args[3]:null;setIsLoading(true);console.log(body);httpAbortCtrl=new AbortController();activeHttpRequests.current.push(httpAbortCtrl);_context.prev=7;_context.next=10;return fetch(url,{method:method,body:body,headers:headers,signal:httpAbortCtrl.signal});case 10:response=_context.sent;_context.next=13;return response.json();case 13:responseData=_context.sent;activeHttpRequests.current=activeHttpRequests.current.filter(function(reqCtrl){return reqCtrl!==httpAbortCtrl;});if(response.ok){_context.next=17;break;}throw new Error(responseData.message);case 17:setIsLoading(false);return _context.abrupt(\"return\",responseData);case 21:_context.prev=21;_context.t0=_context[\"catch\"](7);console.log('dps'+_context.t0.message);setError(_context.t0.message);setIsLoading(false);throw _context.t0;case 27:case\"end\":return _context.stop();}}},_callee,null,[[7,21]]);}));return function(_x){return _ref.apply(this,arguments);};}(),[]);var clearError=function clearError(){setError(null);};useEffect(function(){return function(){// eslint-disable-next-line react-hooks/exhaustive-deps\nactiveHttpRequests.current.forEach(function(abortCtrl){return abortCtrl.abort();});};},[]);return{isLoading:isLoading,error:error,sendRequest:sendRequest,clearError:clearError};};","map":{"version":3,"sources":["D:/WEB_MINI_PROJECT/web/ReactJS/src/Hooks/Http-Hook.js"],"names":["useState","useCallback","useRef","useEffect","useHttpClient","isLoading","setIsLoading","error","setError","activeHttpRequests","sendRequest","url","method","headers","body","console","log","httpAbortCtrl","AbortController","current","push","fetch","signal","response","json","responseData","filter","reqCtrl","ok","Error","message","clearError","forEach","abortCtrl","abort"],"mappings":"+bAAA,OAASA,QAAT,CAAmBC,WAAnB,CAAgCC,MAAhC,CAAwCC,SAAxC,KAAyD,OAAzD,CAEA,MAAO,IAAMC,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,eACCJ,QAAQ,CAAC,KAAD,CADT,wCAC1BK,SAD0B,eACfC,YADe,8BAEPN,QAAQ,EAFD,yCAE1BO,KAF0B,eAEnBC,QAFmB,eAIjC,GAAMC,CAAAA,kBAAkB,CAAGP,MAAM,CAAC,EAAD,CAAjC,CAEA,GAAMQ,CAAAA,WAAW,CAAGT,WAAW,0FAC7B,iBAAOU,GAAP,8LAAYC,MAAZ,+CAAqB,KAArB,CAA4BC,OAA5B,+CAAsC,EAAtC,CAA0CC,IAA1C,+CAAiD,IAAjD,CACER,YAAY,CAAC,IAAD,CAAZ,CACAS,OAAO,CAACC,GAAR,CAAYF,IAAZ,EAEMG,aAJR,CAIwB,GAAIC,CAAAA,eAAJ,EAJxB,CAKET,kBAAkB,CAACU,OAAnB,CAA2BC,IAA3B,CAAgCH,aAAhC,EALF,uCAQ2BI,CAAAA,KAAK,CAACV,GAAD,CAAM,CAChCC,MAAM,CAANA,MADgC,CAEhCE,IAAI,CAAJA,IAFgC,CAGhCD,OAAO,CAAPA,OAHgC,CAIhCS,MAAM,CAAEL,aAAa,CAACK,MAJU,CAAN,CARhC,SAQUC,QARV,sCAe+BA,CAAAA,QAAQ,CAACC,IAAT,EAf/B,SAeUC,YAfV,eAiBIhB,kBAAkB,CAACU,OAAnB,CAA6BV,kBAAkB,CAACU,OAAnB,CAA2BO,MAA3B,CAC3B,SAAAC,OAAO,QAAIA,CAAAA,OAAO,GAAKV,aAAhB,EADoB,CAA7B,CAjBJ,GAqBSM,QAAQ,CAACK,EArBlB,+BAsBY,IAAIC,CAAAA,KAAJ,CAAUJ,YAAY,CAACK,OAAvB,CAtBZ,SAyBIxB,YAAY,CAAC,KAAD,CAAZ,CAzBJ,gCA0BWmB,YA1BX,4DA4BIV,OAAO,CAACC,GAAR,CAAY,MAAM,YAAIc,OAAtB,EAEAtB,QAAQ,CAAC,YAAIsB,OAAL,CAAR,CACAxB,YAAY,CAAC,KAAD,CAAZ,CA/BJ,uFAD6B,+DAoC7B,EApC6B,CAA/B,CAuCA,GAAMyB,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACvBvB,QAAQ,CAAC,IAAD,CAAR,CACD,CAFD,CAIAL,SAAS,CAAC,UAAM,CACd,MAAO,WAAM,CACX;AACAM,kBAAkB,CAACU,OAAnB,CAA2Ba,OAA3B,CAAmC,SAAAC,SAAS,QAAIA,CAAAA,SAAS,CAACC,KAAV,EAAJ,EAA5C,EACD,CAHD,CAID,CALQ,CAKN,EALM,CAAT,CAOA,MAAO,CAAE7B,SAAS,CAATA,SAAF,CAAaE,KAAK,CAALA,KAAb,CAAoBG,WAAW,CAAXA,WAApB,CAAiCqB,UAAU,CAAVA,UAAjC,CAAP,CACD,CAzDM","sourcesContent":["import { useState, useCallback, useRef, useEffect } from 'react';\r\n\r\nexport const useHttpClient = () => {\r\n  const [isLoading, setIsLoading] = useState(false);\r\n  const [error, setError] = useState();\r\n\r\n  const activeHttpRequests = useRef([]);\r\n\r\n  const sendRequest = useCallback(\r\n    async (url, method = 'GET', headers = {}, body = null) => {\r\n      setIsLoading(true);\r\n      console.log(body);\r\n      \r\n      const httpAbortCtrl = new AbortController();\r\n      activeHttpRequests.current.push(httpAbortCtrl);\r\n\r\n      try {\r\n        const response = await fetch(url, {\r\n          method,\r\n          body,\r\n          headers,\r\n          signal: httpAbortCtrl.signal\r\n        });\r\n\r\n        const responseData = await response.json();\r\n\r\n        activeHttpRequests.current = activeHttpRequests.current.filter(\r\n          reqCtrl => reqCtrl !== httpAbortCtrl\r\n        );\r\n\r\n        if (!response.ok) {\r\n          throw new Error(responseData.message);\r\n        }\r\n\r\n        setIsLoading(false);\r\n        return responseData;\r\n      } catch (err) {\r\n        console.log('dps'+err.message);\r\n        \r\n        setError(err.message);\r\n        setIsLoading(false);\r\n        throw err;\r\n      }\r\n    },\r\n    []\r\n  );\r\n\r\n  const clearError = () => {\r\n    setError(null);\r\n  };\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      // eslint-disable-next-line react-hooks/exhaustive-deps\r\n      activeHttpRequests.current.forEach(abortCtrl => abortCtrl.abort());\r\n    };\r\n  }, []);\r\n\r\n  return { isLoading, error, sendRequest, clearError };\r\n};\r\n"]},"metadata":{},"sourceType":"module"}